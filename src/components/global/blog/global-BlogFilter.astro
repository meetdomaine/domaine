---
import { sanityClient } from 'sanity:client';
import { allBlogCategories_Domaine, allBlogCategories_Studio } from '../utils/cms-content';

const { brand, slug } = Astro.props

const blogCategories = brand === "studio" ? allBlogCategories_Studio.data : allBlogCategories_Domaine.data
// const blogCategories = await sanityClient.fetch(`*[_type == "type_blogCategory" && count( *[_type == "type_blog" && agencyBrand->slug.current == '${brand}' && references(^._id)] ) > 0]`)
// console.log(blogCategories)
---
<div class="blog-filters">
    <a
        class="filter" 
        href={`${brand == "studio" ? '/studio' : ''}/insights/`}
        data-active={!slug ? "true" : "false"}
    >All Insights</a>
    {blogCategories.map((category) => (
        <a 
            class="filter"
            href={`${brand == "studio" ? '/studio' : ''}/insights/${category.slug.current}`}
            data-active={slug && slug.current == category.slug.current ? "true" : "false"}
        >{category.title}</a>
    ))}
</div>

<style>
    .blog-filters {
        display: flex;
        flex-direction: row;
        padding-inline: var(--page-margin);
        padding-block: var(--space-md);
        gap: var(--space-sm);
    }

    .filter {
        text-decoration: none;
    }

    .filter[data-active="true"] {
        text-decoration: underline 1px solid;
        text-underline-offset: .2em;
    }
</style>
