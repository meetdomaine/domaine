---
import { getTranslationString } from "../../../lib/translations"
import AtomSanityImage from "../atoms/atom-sanityImage.astro"

const { brand, section, key, locale } = Astro.props
---
<section class="section-stats-carousel">
  <div class="section-title">
    {section.heading && <h2 class="heading h4">{getTranslationString(section.heading, locale)}</h2>}
    {section.subheading && <h3 class="subheading body">{getTranslationString(section.subheading, locale)}</h3>}
  </div>
  <div class="section-content">
    {section.stats.map((stat) => (
      <div class="stat">
        <div class="stat-image" data-color-scheme="invert">
          <AtomSanityImage 
            sizes="30vw"
            image={stat.thumbnailImage.image}
            aspectRatio={1 / 1}
            cover={true}
          />
          <p class="stat-number h1">{getTranslationString(stat.number, locale)}</p>
        </div>
        <p class="stat-label h6">{getTranslationString(stat.label, locale)}</p>
      </div>
    ))}
    {section.stats.map((stat) => (
      <div class="stat">
        <div class="stat-image" data-color-scheme="invert">
          <AtomSanityImage 
            sizes="30vw"
            image={stat.thumbnailImage.image}
            aspectRatio={1 / 1}
            cover={true}
          />
          <p class="stat-number h1">{getTranslationString(stat.number, locale)}</p>
        </div>
        <p class="stat-label h6">{getTranslationString(stat.label, locale)}</p>
      </div>
    ))}
  </div>
</section>

<style>
  .section-stats-carousel {
    padding-inline: var(--page-margin);
    padding-block: var(--space-2xl);
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: var(--space-2xl);
    overflow: hidden;
  }

  .section-title {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    gap: var(--space-lg);
  }

  .heading {
    max-width: 20em;
  }

  .subheading {
    max-width: 30em;
  }

  .section-content {
    --gap: var(--space-md);
    display: flex;
    flex-direction: row;
    gap: var(--gap);
    /* translate: -50% 0; */
    width: max-content;
    animation: ticker-scroll 30s linear 0s infinite;
  }

  .stat {
    flex: 0 0 33vw;
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .stat-image {
    position: relative;
    border-radius: var(--radius-sm);
    overflow: hidden;
  }

  .stat-number {
    position: absolute;
    bottom: var(--space-sm);
    left: var(--space-sm);
    margin: 0;
  }

  @keyframes ticker-scroll {
    to {
      translate: calc(-50% - var(--gap) * 0.5) 0;
    }
  }

  @media screen and (width <= 768px) {
    .section-title {
      flex-direction: column;
      gap: var(--space-xs);
    }

    .stat {
      flex: 0 0 60vw;
    }
  }

</style>