---
import AtomTag from "../atoms/atom-tag.astro"
import AtomLinkCard from "../atoms/atom-linkCard.astro"
import { allBlogPosts_Domaine, allBlogPosts_Studio, allProjects_Domaine, allProjects_Studio } from "../utils/cms-content"

const { section, brand } = Astro.props

const allPosts = brand === "studio" ? allBlogPosts_Studio : allBlogPosts_Domaine
const featuredPost = allPosts.find((post) => post.category.slug.current != "agency-news")
const featuredNews = allPosts.find((post) => post.category.slug.current === "agency-news")
const featuredProject = brand === "studio" ? allProjects_Studio[0] : allProjects_Domaine[0]
---
<section class="section-text-feed">
    <div class="section-content">
        <h1 class="heading h2" data-animate-viewport="true" data-animation="fade-up">{section.heading}</h1>
        <div class="tags">
            {section.stats.map((stat, i) => (
                <div 
                    class="tag-wrapper"
                    data-animate-viewport="true"
                    data-animation="fade"
                    data-animation-delay={150 * i}
                >
                    <AtomTag 
                        title={stat.number}
                        text={stat.label}
                    />
                </div>
            ))}
        </div>
    </div>
    <div class="section-links">
        <div 
            class="link-card-wrapper"
            data-animate-viewport="true"
            data-animation="fade"
            data-animate-mobile="false"
        >
            <AtomLinkCard 
                categoryTitle="Insights"
                title={featuredPost.title}
                image={featuredPost.thumbnailImage.image}
                url={`${brand === "studio" ? "/studio" : ""}/insights/${featuredPost.category.slug.current}/${featuredPost.slug.current}`}
                theme="dark"
            />
        </div>
        <div 
            class="link-card-wrapper"
            data-animate-viewport="true"
            data-animate-mobile="false"
            data-animation="fade"
            data-animation-delay={150}
        >
            <AtomLinkCard 
                categoryTitle="Work"
                title={featuredProject.title}
                excerpt={featuredProject.excerpt}
                image={featuredProject.thumbnailImageSecondary.image}
                url={`${brand === "studio" ? "/studio" : ""}/work/${featuredProject.slug.current}`}
                theme="dark"
            />
        </div>
        <div 
            class="link-card-wrapper"
            data-animate-viewport="true"
            data-animation="fade"
            data-animation-delay={300}
            data-animate-mobile="false"
        >
            <AtomLinkCard 
                categoryTitle="News"
                title={featuredNews.title}
                image={featuredNews.thumbnailImage.image}
                url={`${brand === "studio" ? "/studio" : ""}/insights/${featuredNews.category.slug.current}/${featuredNews.slug.current}`}
                theme="dark"
            />
        </div>
    </div>
</section>

<style>
    .section-text-feed {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        padding-inline: var(--page-margin);
        padding-block: var(--space-2xl);
        gap: var(--space-lg);
    }

    .section-content {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-xs);
    }

    .heading {
        max-width: 16em;
    }

    .tags {
        display: flex;
        flex-direction: row;
        gap: var(--space-2xs);
        flex-wrap: wrap;
    }

    .section-links {
        flex: 1 0 40%;
        max-width: 450px;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        gap: var(--space-xs);
    }

    @media screen and (max-width: 768px) {
        .section-text-feed {
            flex-direction: column;
            align-items: stretch;
            gap: var(--space-2xl);
        }

        .tags {
            flex-direction: column;
            align-items: flex-start;
        }


        .link-card-wrapper:not(:first-child) {
            display: none;
        }

    }
</style>