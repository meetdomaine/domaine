---
import HomeHero from "../components/domaine/sections/home/home-Hero.astro";
import GlobalSectionsList from "../components/global/sections/section-GlobalSectionsList.astro";
import LayoutDomaine from "../layouts/Layout-Domaine.astro";
import { urlFor, imageFields, imageBaseFields, projectGridFields } from "../lib/cms-queries"
import { getTranslationString } from "../lib/translations";
import { Brands } from "../enums/brands";
import { loadQuery } from "../lib/sanity-load-query";

const { locale } = Astro.props;
const { data: pageSettings } = await loadQuery({
  query: `*[_type == "page_home-domaine"][0]{
    metafields{ title, description, image{${imageBaseFields}} },
    projects[]{
      project->{${projectGridFields}},
      image{${imageFields}}
    },
    showPreloader
  }`
})

---
<LayoutDomaine
    title={pageSettings.metafields?.title ? getTranslationString(pageSettings.metafields.title, locale) : null}
    description={pageSettings.metafields?.description ? getTranslationString(pageSettings.metafields.description, locale) : null}
    image={pageSettings.metafields?.image ? urlFor(pageSettings.metafields.image).url() : null}
    searchExposed={true}
    showPreloader={pageSettings.showPreloader}
    locale={locale}
>
  <HomeHero
      locale={locale}
      brand={Brands.DOMAINE}
  />
  <GlobalSectionsList
    brand={Brands.DOMAINE}
    locale={locale}
  />
</LayoutDomaine>