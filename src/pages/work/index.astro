---
// SERVER RENDERED AT LOAD TIME
import { projectGridFields } from '../../lib/cms-queries';
import { Brands } from '../../enums/brands';
import LayoutProjectsIndex from '../../layouts/Layout_ProjectsIndex.astro';
import { sanityClient } from 'sanity:client';

const allProjects = await sanityClient.fetch(`*[_type == "type_project" && agencyBrand->name == '${Brands.DOMAINE}' && isHidden != true]{${projectGridFields}}[0-10] | order(orderRank)`)
if (!allProjects) return Astro.redirect('/404')
---
<LayoutProjectsIndex
    brand={Brands.DOMAINE}
    projects={allProjects}
    isTopLevel
/>
