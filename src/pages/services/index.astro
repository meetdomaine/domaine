---
import { sanityClient } from "sanity:client";
import LayoutDomaine from "../../layouts/Layout-Domaine.astro";
import { paths } from "../../components/global/utils/paths";
import SectionServiceLandingHero from "../../components/global/services/section-ServiceLanding-Hero.astro";
import SectionServiceTypeFeature from "../../components/global/services/section-ServiceType-Feature.astro";

const serviceTypes = await sanityClient.fetch(`
    *[_type == "type_serviceType" 
        && "domaine" in agencyBrands[]->slug.current ]{
            ...,
            "serviceGroups":  *[_type == "type_serviceGroup" && references(^._id)]{
                ...,
                "services": *[_type == "type_service" && references(^._id)]{
                    ...
                } | order(orderRank)
            } | order(orderRank)
        }`)

---
<LayoutDomaine
    title="Services"
    searchFilter="type:page"
>   
    <SectionServiceLandingHero
        eyebrow="Domaine"
        title={"Services"}
    />
    {serviceTypes.map((serviceType) => (
        <SectionServiceTypeFeature 
            serviceType={serviceType}
        />
    ))}
</LayoutDomaine>