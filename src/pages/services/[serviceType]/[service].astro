---
import LayoutDomaine from "../../../layouts/Layout-Domaine.astro"
import SectionServiceHero from "../../../components/global/services/service-Hero.astro"
import SectionProjectsFeed from "../../../components/global/sections/section-ProjectsFeed.astro"
import SectionBlogFeed from "../../../components/global/sections/section-BlogFeed.astro"
import { getServices_Domaine } from "../../../components/global/utils/cms-content"
import SectionForm from "../../../components/global/sections/section-Form.astro"

// export const prerender = true

export async function getStaticPaths() {
    const services = await getServices_Domaine()
    return services.map((service) => {
        return {
            params: { serviceType: service.serviceGroup.serviceType.slug.current, service: service.slug.current },
            props: { content: service, serviceGroup: service.serviceGroup, serviceType: service.serviceGroup.serviceType }
        }
    })
}

interface Props {
    content: any,
    serviceType: any,
    serviceGroup: any,
}

const { content, serviceType, serviceGroup } = Astro.props;
// console.log(content)
---
<LayoutDomaine
    title={content.metafields && content.metafields.title ? content.metafields.title : content.title}
    searchFilter="type:service"
    activePath="/services"
>
    <SectionServiceHero
        title={content.title}
        excerpt={content.excerpt}
        description={content.description}
        breadcrumbs={[
            {
                title: 'Services /',
                url: '/services/'
            },
            {
                title: serviceType.title,
                url: `/services/${serviceType.slug.current}`
            },
        ]}
    />

    {content.relatedBlogPosts && content.relatedBlogPosts.length > 0 &&
        <SectionBlogFeed 
            heading={`${content.title} Insights`}
            posts={content.relatedBlogPosts}
        />
    }

    {content.relatedProjects && content.relatedProjects.length > 0 &&
        <SectionProjectsFeed 
            heading={`${content.title} Work`}
            projects={content.relatedProjects}
            sidebarTitle={content.title}
        />
    }

    <!-- {serviceType.formHeading && serviceType.hubspotFormId &&
        <SectionForm 
            heading={serviceType.formHeading}
            text={serviceType.formText}
            hubspotFormId={serviceType.hubspotFormId}
        />
    } -->

</LayoutDomaine>