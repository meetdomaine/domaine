---
import LayoutPage from "../../layouts/Layout-Page.astro";
import { Brands } from "../../enums/brands";
import LayoutMarketingPage from "../../layouts/Layout_MarketingPage.astro";
import { loadQuery } from "../../lib/sanity-load-query";
import { globalSectionsFields, imageFields, videoFields, imageBaseFields, generalPageFields } from "../../lib/cms-queries";
import { getEnv } from "../../lib/getEnv";

export const prerender = false;

// export async function getStaticPaths() {
//     const { data: pages } = await loadQuery({ 
//         query: `*[_type == "page_studio-general"]{${generalPageFields}} | order(_createdAt desc)`
//     })
    
//     return pages.map((page) => {
//         return {
//             params: { page: page.slug.current },
//             props: { content: page }
//         }
//     })
// }

const { page } = Astro.params
const { data: pageContent } = await loadQuery({ 
    query: `*[ _type == "page_studio-general" && slug.current == '${page}'][0]{${generalPageFields}}`
})

---
{pageContent.isMarketingPage ? 
    <LayoutMarketingPage
        content={pageContent}
        brand={Brands.STUDIO}
    />
    :
    <LayoutPage
        content={pageContent}
        brand={Brands.STUDIO}
    />
}